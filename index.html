<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon">
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <link href="smart-cookies/css/smart-cookies.css" rel="stylesheet">
    <title>Eugene Store (JavaScript + Bootstrap 5)</title>
</head>

<body>
    <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasExample">
        <div class="offcanvas-header">
            <h3>–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤<br>—á–µ—Ä–µ–∑ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª</h3>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
        </div>
        <div class="offcanvas-body">
            <h6>–ß—Ç–æ–±—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ä–∞–∑—É –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤:<br>1. –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª ("txt") —Å –ª—é–±—ã–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º.<br>2.
                –í–Ω–µ—Å–∏—Ç–µ –≤ –Ω–µ–≥–æ —Ç–æ–≤–∞—Ä—ã –ø–æ —à–∞–±–ª–æ–Ω—É –Ω–∏–∂–µ (–∫–∞–∂–¥—ã–π —Ç–æ–≤–∞—Ä –Ω–∞ –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–µ, –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Ä–∞–∑–¥–µ–ª—è—é—Ç—Å—è –∑–∞–ø—è—Ç—ã–º–∏
                (,)).<br>3. –í—ã–±–µ—Ä–∏—Ç–µ —ç—Ç–æ—Ç —Ñ–∞–π–ª –≤ –ø–æ–ª–µ –Ω–∏–∂–µ –∏–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –µ–≥–æ —Ç—É–¥–∞.</h6>
            <input type="file" class="form-control mt-5 mb-5" onchange="readFile(this)">
            <h6>–®–∞–±–ª–æ–Ω:<br>–ê–†–¢–ò–ö–£–õ,–ù–ê–ó–í–ê–ù–ò–ï,–¶–ï–ù–ê,–ö–û–õ–ò–ß–ï–°–¢–í–û,–ö–ê–¢–ï–ì–û–†–ò–Ø<br>123,–¢–æ–≤–∞—Ä,100,50,–¢–µ—Ö–Ω–∏–∫–∞</h6>
        </div>
    </div>

    <div class="topcornerleft">üëã–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –Ω–∞—à –º–∞–≥–∞–∑–∏–Ω Eugene Store!üëã –£–¥–∞—á–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫!üëç</div>
    <div class="topcornerright">‚ù§–°–¥–µ–ª–∞–Ω–æ —Å –ª—é–±–æ–≤—å—é –≤ –∫–æ–º–ø–∞–Ω–∏–∏ Eugene Blogs Company‚ù§</div>
    <div class="mobiletext text-center">üëã–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –Ω–∞—à –º–∞–≥–∞–∑–∏–Ω Eugene Store!üëã –£–¥–∞—á–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫!üëç</div>
    <div class="mobiletext text-center">‚ù§–°–¥–µ–ª–∞–Ω–æ —Å –ª—é–±–æ–≤—å—é –≤ –∫–æ–º–ø–∞–Ω–∏–∏ Eugene Blogs Company‚ù§</div>
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-xxl-6">
                <div class="goods_box" id="goods">
                    <div class="menu">
                        <input type="text" placeholder="–ü–æ–∏—Å–∫" class="search" title="–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–∞">
                        <button class="add btn-success" data-bs-toggle="modal" data-bs-target="#exampleModal"
                            title="–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä –≤ —Å–ø–∏—Å–æ–∫">&#10010;</button>
                        <button class="add btn-warning" data-bs-toggle="offcanvas" data-bs-target="#offcanvasExample"
                            title="–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã —á–µ—Ä–µ–∑ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª">&#8801;</button>
                        <button class="deleteall btn-danger" onclick="DeleteAll()"
                            title="–û—á–∏—Å—Ç–∏—Ç—å –≤–µ—Å—å —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤">&#10006;</button>
                        <button class="save-goods deleteall btn-primary"
                            title="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–≤–∞—Ä—ã –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª">üíæ</button>
                        <button class="deleteall btn-dark" data-bs-toggle="modal" data-bs-target="#qr-code"
                            title="–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä QR-–∫–æ–¥–æ–≤">QR</button>
                    </div>
                    <div class="table-responsive">
                        <table class="goods table mt-3" id="table1">
                            <thead>
                                <tr class="table-primary align-middle">
                                    <th data-type="number">‚Ññ</th>
                                    <th data-type="number">–ê—Ä—Ç–∏–∫—É–ª</th>
                                    <th data-type="string">–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                                    <th data-type="number">–¶–µ–Ω–∞, &#8381;</th>
                                    <th data-type="number">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
                                    <th data-type="string">–ö–∞—Ç–µ–≥–æ—Ä–∏—è —Ç–æ–≤–∞—Ä–∞</th>
                                    <th></th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody class="list">

                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="col-xs-12 col-xxl-6">
                <div class="price_box">
                    <div class="menu">
                        <div class="price_title">–ò—Ç–æ–≥–æ: <span class="price_result">0 &#8381;</span></div>
                        <button class="deleteallcart btn-danger" onclick="DeleteAllCart()"
                            title="–í–µ—Ä–Ω—É—Ç—å –≤—Å–µ —Ç–æ–≤–∞—Ä—ã –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã –≤ —Å–ø–∏—Å–æ–∫">&#10006;</button>
                        <button class="deleteallcart btn-warning" onclick="DeleteAllCartForever()"
                            title="–£–¥–∞–ª–∏—Ç—å –≤—Å–µ —Ç–æ–≤–∞—Ä—ã –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã">&#128465;</button>
                    </div>
                    <div class="table-responsive text-center">
                        <table class="price table mt-3" id="table2">
                            <thead>
                                <tr class="table-primary align-middle">
                                    <th data-type="number">‚Ññ</th>
                                    <th data-type="number">–ê—Ä—Ç–∏–∫—É–ª</th>
                                    <th data-type="string">–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                                    <th data-type="number">–¶–µ–Ω–∞/—à—Ç, &#8381;</th>
                                    <th data-type="number">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
                                    <th>–°–∫–∏–¥–∫–∞, %</th>
                                    <th data-type="number">–¶–µ–Ω–∞, &#8381;</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody class="cart" id="cart">

                            </tbody>
                        </table>
                        <button class="btn btn-info print-button">üñ® –ù–∞–ø–µ—á–∞—Ç–∞—Ç—å —á–µ–∫</button>
                        <button class="btn btn-warning money-button">üí∞ –í–Ω–µ—Å—Ç–∏ –¥–µ–Ω—å–≥–∏</button>
                    </div>
                </div>
            </div>
            <div class="col-xs-12 col-xxl-6"></div>
        </div>
    </div>

    <div class="container qr mt-5">
        <div class="row text-center">
            <div class="col-xl-6 col-md-12 col-sm-12 mt-3">
                <h3>–°–∫–∞–Ω–µ—Ä QR-–∫–æ–¥–æ–≤</h3>
                <p>–†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.</p>
                <div style="width: 500px" id="reader"></div>
            </div>
            <div class="col-xl-6 col-md-12 col-sm-12 mt-3">
                <h3>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ QR-–∫–æ–¥—ã</h3>
                <p>–û—Ç—Å–∫–∞–Ω–∏—Ä—É–π—Ç–µ –∏—Ö –∏ —Å–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º.</p>
                <div class="row">
                    <div class="col-xl-4 col-md-6 col-sm-12">
                        <h6>QR-–∫–æ–¥ –¥–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞ –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω—É.</h6>
                        <a href="img/QR-–∫–æ–¥ –í—Å–µ —Ç–æ–≤–∞—Ä—ã.png" download="" class="btn btn-danger">–°–∫–∞—á–∞—Ç—å</a>
                    </div>
                    <div class="col-xl-4 col-md-6 col-sm-12">
                        <h6>QR-–∫–æ–¥ –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ —Ç–æ–≤–∞—Ä–∞.</h6>
                        <a href="img/QR-–∫–æ–¥ –í–æ–∑–≤—Ä–∞—Ç.png" download="" class="btn btn-danger">–°–∫–∞—á–∞—Ç—å</a>
                    </div>
                    <div class="col-xl-4 col-md-6 col-sm-12">
                        <h6>QR-–∫–æ–¥ –¥–ª—è —Å–∫–∏–¥–∫–∏.</h6>
                        <a href="img/QR-–∫–æ–¥ –°–∫–∏–¥–∫–∞.png" download="" class="btn btn-danger">–°–∫–∞—á–∞—Ç—å</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="exampleModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title" id="exampleModalLabel">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <label for="good_article" class="form-label">–ê—Ä—Ç–∏–∫—É–ª —Ç–æ–≤–∞—Ä–∞</label>
                    <input type="text" class="form-control" id="good_article" maxlength="15">
                    <a class="help_article">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∞—Ä—Ç–∏–∫—É–ª</a>
                    <br>
                    <label for="good_name" class="form-label mt-3">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</label>
                    <input type="text" class="form-control mb-3" id="good_name" maxlength="40">
                    <label for="good_price" class="form-label">–¶–µ–Ω–∞</label>
                    <input type="text" class="form-control mb-3" id="good_price">
                    <label for="good_count" class="form-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</label>
                    <input type="text" class="form-control mb-3" id="good_count">
                    <label for="good_category" class="form-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è —Ç–æ–≤–∞—Ä–∞</label>
                    <input type="text" class="form-control mb-3" id="good_category" maxlength="50">
                    <button type="submit" class="add_new btn btn-success">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="qr-code" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title" id="exampleModalLabel">–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä QR-–∫–æ–¥–æ–≤</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <input class="form-control" id="user-text-qr" type="text" placeholder="–ê—Ä—Ç–∏–∫—É–ª —Ç–æ–≤–∞—Ä–∞"
                        onblur="Generate()" />
                    <br>
                    <div id="qr"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/sweetalert2.all.min.js"></script>
    <script src="js/list.min.js"></script>
    <script src="js/main.js"></script>
    <script src="smart-cookies/js/smart-cookies.js"></script>
    <script src="js/html5-qrcode.min.js"></script>
    <script src="js/qrcode.min.js"></script>
    <script>
        let refund = false
        function onScanSuccess(decodedText, decodedResult) {
            let goods = JSON.parse(localStorage.getItem('goods'))
            if (refund == false) {
                let items = 0
                for (let i = 0; i < goods.length; i++) {
                    if (goods[i][8] == decodedText) {
                        if (goods[i][3] > 0) {
                            goods[i].splice(3, 1, goods[i][3] - 1)
                            goods[i].splice(4, 1, goods[i][4] + 1)
                            localStorage.setItem('goods', JSON.stringify(goods))
                            update_goods()
                        } else {
                            Swal.fire(
                                "–¢–æ–≤–∞—Ä –∑–∞–∫–æ–Ω—á–∏–ª—Å—è!",
                                "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ = 0.",
                                "info"
                            )
                        }
                        break;
                    } else {
                        items++
                    }
                }
                if (items == goods.length) {
                    if (decodedText == "All") {
                        let timerInterval
                        Swal.fire({
                            title: '–ó–∞–≥—Ä—É–∑–∫–∞',
                            html: '–ü–µ—Ä–µ–Ω–æ—Å –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω—É –∑–∞–π–º—ë—Ç –µ—â—ë <b></b> –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥.',
                            timer: 3500,
                            timerProgressBar: true,
                            didOpen: () => {
                                Swal.showLoading()
                                const b = Swal.getHtmlContainer().querySelector('b')
                                timerInterval = setInterval(() => {
                                    b.textContent = Swal.getTimerLeft()
                                }, 10)
                            },
                            willClose: () => {
                                clearInterval(timerInterval)
                            }
                        }).then((result) => {
                            if (result.dismiss === Swal.DismissReason.timer) {
                                for (let i = 0; i < goods.length; i++) {
                                    while (goods[i][3] > 0) {
                                        goods[i].splice(3, 1, goods[i][3] - 1)
                                        goods[i].splice(4, 1, goods[i][4] + 1)
                                    }
                                }
                                localStorage.setItem('goods', JSON.stringify(goods))
                                update_goods()
                            }
                        })
                    } else if (decodedText == "Refund") {
                        Swal.fire({
                            title: '–í–æ–∑–≤—Ä–∞—Ç?',
                            text: "–í—ã —Ö–æ—Ç–∏—Ç–µ –≤–µ—Ä–Ω—É—Ç—å —Ç–æ–≤–∞—Ä?",
                            icon: 'question',
                            showCancelButton: true,
                            confirmButtonColor: 'green',
                            cancelButtonColor: 'red',
                            confirmButtonText: '–î–∞',
                            cancelButtonText: '–ù–µ—Ç'
                        }).then((result) => {
                            if (result.isConfirmed) {
                                refund = true
                                Swal.fire(
                                    '–í–æ–∑–≤—Ä–∞—Ç',
                                    '–¢–µ–ø–µ—Ä—å –æ—Ç—Å–∫–∞–Ω–∏—Ä—É–π—Ç–µ QR-–∫–æ–¥–∞ —Ç–æ–≤–∞—Ä–∞ –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞.',
                                    'warning'
                                )
                            }
                        })
                    } else if (decodedText == "Discount") {
                        Swal.fire({
                            title: '–°–∫–∏–¥–∫–∞ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö',
                            input: 'text',
                            inputAttributes: {
                                autocapitalize: 'off',
                                min: "0",
                                max: "100"
                            },
                            showCancelButton: true,
                            confirmButtonColor: 'green',
                            cancelButtonColor: 'red',
                            confirmButtonText: '–ü—Ä–∏–Ω—è—Ç—å',
                            cancelButtonText: '–û—Ç–º–µ–Ω–∏—Ç—å',
                            preConfirm: (Sale) => {
                                let text_in = document.querySelector(".price_result").innerHTML.substring(0, document.querySelector(".price_result").innerHTML.length - 1)
                                let result_sale = eval(Number(text_in) * (Number(Sale) / 100))
                                document.getElementById('cart').insertAdjacentHTML('beforeend',
                                    ` 
                <tr class="align-middle">
                <td></td>
                <td class="price_article"></td>
                <td class="price_name">–°–∫–∏–¥–∫–∞</td>
                <td class="price_one">${Sale}%</td>
                <td class="price_count"></td>
                <td class="price_discount"></td>
                <td>-${result_sale}</td>
                <td></td>
                </tr>      
                `)
                                document.querySelector('.price_result').innerHTML = eval(Number(text_in) - Number(result_sale)) + '&#8381;'
                                Swal.fire(
                                    '–°–∫–∏–¥–∫–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞!',
                                    '–ò—Ç–æ–≥–æ–≤–∞—è —Ü–µ–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∞.',
                                    'success'
                                )
                            }
                        })
                    } else {
                        Swal.fire({
                            icon: 'error',
                            title: '–û—à–∏–±–∫–∞',
                            text: `–¢–æ–≤–∞—Ä —Å –¥–∞–Ω–Ω—ã–º –∞—Ä—Ç–∏–∫—É–ª–æ–º (${decodedText}) –Ω–µ –Ω–∞–π–¥–µ–Ω!`,
                        })
                    }
                }
            } else {
                refund = false
                let items = 0
                for (let i = 0; i < goods.length; i++) {
                    if (goods[i][8] == decodedText) {
                        goods[i].splice(3, 1, goods[i][3] + 1)
                        Swal.fire(
                            "–£—Å–ø–µ—à–Ω–æ!",
                            `–ú—ã –≤–µ—Ä–Ω—É–ª–∏ 1 —Ç–æ–≤–∞—Ä —Å –∞—Ä—Ç–∏–∫—É–ª–æ–º "${decodedText}".`,
                            "success"
                        )
                        localStorage.setItem('goods', JSON.stringify(goods))
                        update_goods()
                    } else {
                        items++
                    }
                }
                if (items == goods.length) {
                    Swal.fire({
                        icon: 'error',
                        title: '–û—à–∏–±–∫–∞',
                        text: `–¢–æ–≤–∞—Ä —Å –¥–∞–Ω–Ω—ã–º –∞—Ä—Ç–∏–∫—É–ª–æ–º (${decodedText}) –Ω–µ –Ω–∞–π–¥–µ–Ω!`,
                    })
                }
            }
        }
        var html5QrcodeScanner = new Html5QrcodeScanner(
            "reader", { fps: 1, qrbox: 250 });
        html5QrcodeScanner.render(onScanSuccess);
    </script>
</body>

</html>
